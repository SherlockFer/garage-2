pipeline{
    agent any 
       
    options {
        disableConcurrentBuilds()
        buildDiscarder(logRotator(numToKeepStr: '5'))
    }
    
    stages{       
        
        stage('Git: Clone') { 
            steps{                    
                git credentialsId: "jenkins-rsa", branch: "master", url: "git@github.com:SherlockFer/quickpoll.git"              
            }
        } 
        
        stage('Mvn: Compile package') { 
            steps{                    
                sh "mvn clean compile package"              
            }
        }  
        
        stage('Docker: Boot: Geolocation') { 
            steps{                    
                sh "docker-compose up --build geolocation"              
            }
        }
        
        stage('Docker: Boot: Api') { 
            steps{                    
                sh "docker-compose up --build api"              
            }
        }        
        
    }
  
}